filter {
  if [icinga][facility] == "Checkable" {
    if [message] =~ /^Notifications are disabled for/ {
      grok {
        match => ["message","Notifications are disabled for %{WORD:[icinga][objecttype]} '%{DATA:[icinga][object]}'."]
        id => "icinga_notificationsdisabled"
        add_tag => "icinga_notificationsdisabled"
        tag_on_failure => ["_grokparsefailure","icinga_notificationsdisabled_failed"]
        add_field => {
          "[icinga][eventtype]" => "notificationsdisabled"
        }
      }
    } else if [message] =~ /^Checking for configured notifications for object / {
      grok {
        match => ["message","Checking for configured notifications for object '%{DATA:[icinga][object]}'"]
        id => "icinga_checkingfornotifications"
        add_tag => "icinga_checkingfornotifications"
        tag_on_failure => ["_grokparsefailure","icinga_checkingfornotifications_failed"]
        add_field => {
          "[icinga][eventtype]" => "checkingfornotifications"
        }
      }
    } else if [message] =~ /^Checkable '.+' has / {
      grok {
        match => ["message","Checkable '%{DATA:[icinga][object]}' has %{INT:[icinga][notificationcount]} notification"]
        id => "icinga_checkablenotification"
        add_tag => "icinga_checkablenotification"
        tag_on_failure => ["_grokparsefailure","icinga_checkablenotification_failed"]
        add_field => {
          "[icinga][eventtype]" => "checkablenotification"
        }
      }
    }
  }
}
